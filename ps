<#
.SYNOPSIS
    Renames multiple files in the current directory based on a specific pattern.

.DESCRIPTION
    This script looks for files whose names start with "12" and replaces that
    prefix with "01". For example, a file named "12 nn 2025.txt" will be renamed to
    "01 nn 2025.txt".

.EXAMPLE
    PS C:\YourFolder> .\RenameMultipleFilesWithPattern.ps1
    Renamed '12 nn 2025.txt' to '01 nn 2025.txt'
    Renamed '12 data.docx' to '01 data.docx'
#>

# Retrieve all files in the current directory.
$files = Get-ChildItem -File

if ($files.Count -eq 0) {
    Write-Host "No files found in the current directory."
    exit
}

foreach ($file in $files) {
    # Check if the file name starts with "12"
    if ($file.Name -match '^12') {
        # Replace "12" at the beginning with "01"
        $newName = $file.Name -replace '^12', '01'
        
        try {
            Rename-Item -Path $file.FullName -NewName $newName -ErrorAction Stop
            Write-Host "Renamed '$($file.Name)' to '$newName'"
        }
        catch {
            Write-Host "Error renaming '$($file.Name)': $_" -ForegroundColor Red
        }
    }
}
